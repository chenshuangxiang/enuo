//微信分享$(function(){var ua = window.navigator.userAgent.toLowerCase();if (ua.match(/MicroMessenger/i) == 'micromessenger'){	//获取code	var code;//	alert(window.location.href);	if(window.location.search.split("?")[1]){		code=window.location.search.split("?")[1].split("&")[0].split("=")[1];		console.log(code);//		alert(code);		//分享朋友圈链接的参数		if(code=="timeline"){//			alert("timeline重定向");			window.location.href = "https://open.weixin.qq.com/connect/oauth2/authorize?appid=wx93fbc4fe8202b82b&redirect_uri=https://www.enuo120.com/cm/activity/tweet/beautyTweet.html&response_type=code&scope=snsapi_userinfo&state=1&connect_redirect=1#wechat_redirect";		}		//分享朋友链接的参数		if(code=="singlemessage"){//			alert("timeline重定向");			window.location.href = "https://open.weixin.qq.com/connect/oauth2/authorize?appid=wx93fbc4fe8202b82b&redirect_uri=https://www.enuo120.com/cm/activity/tweet/beautyTweet.html&response_type=code&scope=snsapi_userinfo&state=1&connect_redirect=1#wechat_redirect";		}	}	//重定向	if(code){	}else{//		alert("重定向");		window.location.href = "https://open.weixin.qq.com/connect/oauth2/authorize?appid=wx93fbc4fe8202b82b&redirect_uri=https://www.enuo120.com/cm/activity/tweet/beautyTweet.html&response_type=code&scope=snsapi_userinfo&state=1&connect_redirect=1#wechat_redirect";	}	//获取权限信息	if(code=="timeline"){		return false;	}	if(code){		var url=window.location.href;		console.log(url);		var data = {			"url":url		}		console.log(data);		$.get("http://47.95.254.125/wx/getSign.json",data,function(res){//			alert("29行"+res);			console.log(res.data);			var msg = res.data;			console.log(msg.signature);			//通过config接口注入权限验证配置			wx.config({				debug: false, // 开启调试模式,调用的所有api的返回值会在客户端alert出来，若要查看传入的参数，可以在pc端打开，参数信息会通过log打出，仅在pc端时才会打印。	            appId: msg.appId, // 必填，公众号的唯一标识	            timestamp: msg.timestamp, // 必填，生成签名的时间戳	            nonceStr: msg.nonceStr, // 必填，生成签名的随机串	            signature: msg.signature,// 必填，签名，见附录1	            //需要用的微信功能接口	            jsApiList:[	            	'onMenuShareTimeline',	            	'onMenuShareAppMessage',            	    'onMenuShareQQ',            	    'onMenuShareWeibo',            	    'onMenuShareQZone'	            ]			});		});	}	//通过ready接口处理成功验证	wx.ready(function(){//		alert("通过ready接口处理成功验证success");		//分享朋友圈		wx.onMenuShareTimeline({		    title: '注意！一大波现金红包向你袭来！', // 分享标题				    link: 'https://www.enuo120.com/cm/activity/tweet/beautyTweet.html', // 分享链接，该链接域名或路径必须与当前页面对应的公众号JS安全域名一致				    imgUrl: 'https://www.enuo120.com/cm/activity/tweet/img/logo.jpg', // 分享图标				    success: function () { 		        // 用户确认分享后执行的回调函数//				alert("分享朋友圈成功了");				var data = {					"activityId":"1",					"code":code				}				console.log(data);				$.post("http://47.95.254.125/app/activity/sendRedpack",data,function(res){					console.log(res);//					res = JSON.parse(res);//					console.log(res);					if(res.success==true){						alert(res.data);					}else{						alert(res.data);					}				},"json");		    },		    cancel: function () { 				alert("分享朋友圈失败了");		        // 用户取消分享后执行的回调函数		    }				});				//获取“分享给朋友”按钮点击状态及自定义分享内容接口		wx.onMenuShareAppMessage({		    title: '注意！一大波现金红包向你袭来！', // 分享标题		    desc: '分享链接朋友圈后到e诺公众号领红包', // 分享描述		    link: 'https://www.enuo120.com/cm/activity/tweet/beautyTweet.html', // 分享链接，该链接域名或路径必须与当前页面对应的公众号JS安全域名一致		    imgUrl: 'https://www.enuo120.com/cm/activity/tweet/img/logo.jpg', // 分享图标		    type: '', // 分享类型,music、video或link，不填默认为link		    dataUrl: '', // 如果type是music或video，则要提供数据链接，默认为空		    success: function () {//		        // 用户确认分享后执行的回调函数				alert("分享朋友成功了");//				var data = {//					"openid":window.localStorage.getItem("openid")//				}//				console.log(data);//				$.post("http://47.95.254.125:8080/enuoact/getMoreAccount",data,function(res){//					alert(JSON.stringify(res));//					if(res.code=='0'){//						alert(res.msg);//					}else{//						alert(res.msg);//					}//				});		    },			cancel: function () {                // 用户取消分享后执行的回调函数//				alert("分享朋友失败了");            }		});		//获取“分享到QQ”按钮点击状态及自定义分享内容接口		wx.onMenuShareQQ({		    title: '注意！一大波现金红包向你袭来！', // 分享标题		    desc: '分享链接朋友圈后到e诺公众号领红包', // 分享描述		    link: 'https://www.enuo120.com/cm/activity/tweet/beautyTweet.html', // 分享链接		    imgUrl: 'https://www.enuo120.com/cm/activity/tweet/img/logo.jpg', // 分享图标		    success: function () {//		       // 用户确认分享后执行的回调函数//				alert("分享到QQ成功了");//				var data = {//					"openid":window.localStorage.getItem("openid")//				}//				console.log(data);//				$.post("http://47.95.254.125:8080/enuoact/getMoreAccount",data,function(res){//					alert(JSON.stringify(res));//					if(res.code=='0'){//						alert(res.msg);//					}else{//						alert(res.msg);//					}//				});		    },				    cancel: function () { 		//		       // 用户取消分享后执行的回调函数//				alert("分享到QQ失败了");		    }				});				//获取“分享到腾讯微博”按钮点击状态及自定义分享内容接口		wx.onMenuShareWeibo({				    title: '注意！一大波现金红包向你袭来！', // 分享标题				    desc: '分享链接朋友圈后到e诺公众号领红包', // 分享描述				    link: 'https://www.enuo120.com/cm/activity/tweet/beautyTweet.html', // 分享链接				    imgUrl: 'https://www.enuo120.com/cm/activity/tweet/img/logo.jpg', // 分享图标				    success: function () { 		//		       // 用户确认分享后执行的回调函数//				alert("分享到腾讯微博成功了");//				var data = {//					"openid":window.localStorage.getItem("openid")//				}//				console.log(data);//				$.post("http://47.95.254.125:8080/enuoact/getMoreAccount",data,function(res){//					alert(JSON.stringify(res));//					if(res.code=='0'){//						alert(res.msg);//					}else{//						alert(res.msg);//					}//				});		    },				    cancel: function () { 				        // 用户取消分享后执行的回调函数//				alert("分享到腾讯微博失败了");		    }				});				//获取“分享到QQ空间”按钮点击状态及自定义分享内容接口		wx.onMenuShareQZone({				    title: '注意！一大波现金红包向你袭来！', // 分享标题				    desc: '分享链接朋友圈后到e诺公众号领红包', // 分享描述				    link: 'https://www.enuo120.com/cm/activity/tweet/beautyTweet.html', // 分享链接				    imgUrl: 'https://www.enuo120.com/cm/activity/tweet/img/logo.jpg', // 分享图标				    success: function () { 		//		       // 用户确认分享后执行的回调函数//				alert("分享到QQ空间成功了");//				var data = {//					"openid":window.localStorage.getItem("openid")//				}//				console.log(data);//				$.post("http://47.95.254.125:8080/enuoact/getMoreAccount",data,function(res){//					alert(JSON.stringify(res));//					if(res.code=='0'){//						alert(res.msg);//					}else{//						alert(res.msg);//					}//				});		    },				    cancel: function () { 				        // 用户取消分享后执行的回调函数//				alert("分享到QQ空间失败了");		    }				});			});		//通过error接口处理失败验证	wx.error(function(res){		alert("通过error接口处理失败验证"+JSON.stringify(res));	});}	});